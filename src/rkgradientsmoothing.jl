## calğ—š
function calğ—š!(ap::ReproducingKernel)
    ğ“– = ap.ğ“–
    ğ—š = ap.ğ— [:âˆ‡Ìƒ]
    n = getğ‘›ğ’’(ap)
    fill!(ğ—š,0.0)
    for Î¾ in ğ“–
        w = getğ‘¤(ap,Î¾)
        ğ’’ = getğ’’(ap,Î¾)
        for I in 1:n
            for J in I:n
                ğ—š[I,J] += w*ğ’’[I]*ğ’’[J]
            end
        end
    end
    cholesky!(ğ—š)
    Uâ»Â¹ = inverse!(ğ—š)
    ğ—šâ»Â¹ = UUáµ€!(Uâ»Â¹)
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{ğƒ,:Quadratic1D,ğ‘ ,ğœ™,:Seg2}) where {ğƒ<:AbstractNode,ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = ap.ğ— [:âˆ‡Ìƒ]
    fill!(ğ—šâ»Â¹,0.0)
    ğ¿ = getğ¿(ap)
    ğ—šâ»Â¹[1] =  4.0/ğ¿
    ğ—šâ»Â¹[2] = -6.0/ğ¿
    ğ—šâ»Â¹[3] = 12.0/ğ¿
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{ğƒ,:Cubic1D,ğ‘ ,ğœ™,:Seg2}) where {ğƒ<:AbstractNode,ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = ap.ğ— [:âˆ‡Ìƒ]
    fill!(ğ—šâ»Â¹,0.0)
    ğ¿ = getğ¿(ap)
    ğ—šâ»Â¹[1] =    9.0/ğ¿
    ğ—šâ»Â¹[2] =  -36.0/ğ¿
    ğ—šâ»Â¹[3] =  192.0/ğ¿
    ğ—šâ»Â¹[4] =   30.0/ğ¿
    ğ—šâ»Â¹[5] = -180.0/ğ¿
    ğ—šâ»Â¹[6] =  180.0/ğ¿
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{ğƒ,:Linear2D,ğ‘ ,ğœ™,:Tri3}) where {ğƒ<:AbstractNode,ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = ap.ğ— [:âˆ‡Ìƒ]
    fill!(ğ—šâ»Â¹,0.0)
    ğ´ = getğ´(ap)
    ğ—šâ»Â¹[1] = 1.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{ğƒ,:Quadratic2D,ğ‘ ,ğœ™,:Tri3}) where {ğƒ<:AbstractNode,ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = ap.ğ— [:âˆ‡Ìƒ]
    fill!(ğ—šâ»Â¹,0.0)
    ğ´ = getğ´(ap)
    ğ—šâ»Â¹[1] =   9.0/ğ´
    ğ—šâ»Â¹[2] = -12.0/ğ´
    ğ—šâ»Â¹[3] =  24.0/ğ´
    ğ—šâ»Â¹[4] = -12.0/ğ´
    ğ—šâ»Â¹[5] =  12.0/ğ´
    ğ—šâ»Â¹[6] =  24.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{ğƒ,:Cubic2D,ğ‘ ,ğœ™,:Tri3}) where {ğƒ<:AbstractNode,ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = ap.ğ— [:âˆ‡Ìƒ]
    fill!(ğ—šâ»Â¹,0.0)
    ğ´ = getğ´(ap)
    ğ—šâ»Â¹[1] =   36.0/ğ´
    ğ—šâ»Â¹[2] = -120.0/ğ´
    ğ—šâ»Â¹[3] =  600.0/ğ´
    ğ—šâ»Â¹[4] = -120.0/ğ´
    ğ—šâ»Â¹[5] =  300.0/ğ´
    ğ—šâ»Â¹[6] =  600.0/ğ´
    ğ—šâ»Â¹[7] =   90.0/ğ´
    ğ—šâ»Â¹[8] = -540.0/ğ´
    ğ—šâ»Â¹[9] = -180.0/ğ´
    ğ—šâ»Â¹[10] =  540.0/ğ´
    ğ—šâ»Â¹[11] =  180.0/ğ´
    ğ—šâ»Â¹[12] = -720.0/ğ´
    ğ—šâ»Â¹[13] = -720.0/ğ´
    ğ—šâ»Â¹[14] =  540.0/ğ´
    ğ—šâ»Â¹[15] = 1440.0/ğ´
    ğ—šâ»Â¹[16] =   90.0/ğ´
    ğ—šâ»Â¹[17] = -180.0/ğ´
    ğ—šâ»Â¹[18] = -540.0/ğ´
    ğ—šâ»Â¹[19] =   90.0/ğ´
    ğ—šâ»Â¹[20] =  540.0/ğ´
    ğ—šâ»Â¹[21] =  540.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—šâ‚‚!(ap::ReproducingKernel{ğƒ,:Quadratic2D,ğ‘ ,ğœ™,:Tri3}) where {ğƒ<:AbstractNode,ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = ap.ğ— [:âˆ‡Ìƒ]
    fill!(ğ—šâ»Â¹,0.0)
    ğ´ = getğ´(ap)
    ğ—šâ»Â¹[1] = 1.0/ğ´
    return ğ—šâ»Â¹
end
function calğ—šâ‚‚!(ap::ReproducingKernel{ğƒ,:Cubic2D,ğ‘ ,ğœ™,:Tri3}) where {ğƒ<:AbstractNode,ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = ap.ğ— [:âˆ‡Ìƒ]
    fill!(ğ—šâ»Â¹,0.0)
    ğ´ = getğ´(ap)
    ğ—šâ»Â¹[1] =   9.0/ğ´
    ğ—šâ»Â¹[2] = -12.0/ğ´
    ğ—šâ»Â¹[3] =  24.0/ğ´
    ğ—šâ»Â¹[4] = -12.0/ğ´
    ğ—šâ»Â¹[5] =  12.0/ğ´
    ğ—šâ»Â¹[6] =  24.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—šâ‚‚!(ap::ReproducingKernel{ğƒ,:Quartic2D,ğ‘ ,ğœ™,:Tri3}) where {ğƒ<:AbstractNode,ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = ap.ğ— [:âˆ‡Ìƒ]
    fill!(ğ—šâ»Â¹,0.0)
    ğ´ = getğ´(ap)
    ğ—šâ»Â¹[1] =   36.0/ğ´
    ğ—šâ»Â¹[2] = -120.0/ğ´
    ğ—šâ»Â¹[3] =  600.0/ğ´
    ğ—šâ»Â¹[4] = -120.0/ğ´
    ğ—šâ»Â¹[5] =  300.0/ğ´
    ğ—šâ»Â¹[6] =  600.0/ğ´
    ğ—šâ»Â¹[7] =   90.0/ğ´
    ğ—šâ»Â¹[8] = -540.0/ğ´
    ğ—šâ»Â¹[9] = -180.0/ğ´
    ğ—šâ»Â¹[10] =  540.0/ğ´
    ğ—šâ»Â¹[11] =  180.0/ğ´
    ğ—šâ»Â¹[12] = -720.0/ğ´
    ğ—šâ»Â¹[13] = -720.0/ğ´
    ğ—šâ»Â¹[14] =  540.0/ğ´
    ğ—šâ»Â¹[15] = 1440.0/ğ´
    ğ—šâ»Â¹[16] =   90.0/ğ´
    ğ—šâ»Â¹[17] = -180.0/ğ´
    ğ—šâ»Â¹[18] = -540.0/ğ´
    ğ—šâ»Â¹[19] =   90.0/ğ´
    ğ—šâ»Â¹[20] =  540.0/ğ´
    ğ—šâ»Â¹[21] =  540.0/ğ´
    return ğ—šâ»Â¹
end

## get shape for SNode
function getâˆ‡âˆ‡ÌƒÂ²ğ­(ap::ReproducingKernel,Î¾::SNode)
    ğ­ = ap.ğ­[:âˆ‚1]
    âˆ‚ğ­âˆ‚x = ap.ğ­[:âˆ‚x]
    âˆ‚ğ­âˆ‚y = ap.ğ­[:âˆ‚y]
    âˆ‚Â²ğ­âˆ‚xÂ² = ap.ğ­[:âˆ‚xÂ²]
    âˆ‚Â²ğ­âˆ‚xâˆ‚y = ap.ğ­[:âˆ‚xâˆ‚y]
    âˆ‚Â²ğ­âˆ‚yÂ² = ap.ğ­[:âˆ‚yÂ²]
    âˆ‚Â³ğ­âˆ‚xÂ³ = ap.ğ­[:âˆ‚xÂ³]
    âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y = ap.ğ­[:âˆ‚xÂ²âˆ‚y]
    âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ² = ap.ğ­[:âˆ‚xâˆ‚yÂ²]
    âˆ‚Â³ğ­âˆ‚yÂ³ = ap.ğ­[:âˆ‚yÂ³]
    i = Î¾.id
    index = Î¾.index
    for j in 1:length(ap.ğ“’)
        ğ­[j] = Î¾.ğ­[:âˆ‚1][index[i]+j]
        âˆ‚ğ­âˆ‚x[j] = Î¾.ğ­[:âˆ‚x][index[i]+j]
        âˆ‚ğ­âˆ‚y[j] = Î¾.ğ­[:âˆ‚y][index[i]+j]
        âˆ‚Â²ğ­âˆ‚xÂ²[j] = Î¾.ğ­[:âˆ‚xÂ²][index[i]+j]
        âˆ‚Â²ğ­âˆ‚xâˆ‚y[j] = Î¾.ğ­[:âˆ‚xâˆ‚y][index[i]+j]
        âˆ‚Â²ğ­âˆ‚yÂ²[j] = Î¾.ğ­[:âˆ‚yÂ²][index[i]+j]
        âˆ‚Â³ğ­âˆ‚xÂ³[j] = Î¾.ğ­[:âˆ‚xÂ³][index[i]+j]
        âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y[j] = Î¾.ğ­[:âˆ‚xÂ²âˆ‚y][index[i]+j]
        âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ²[j] = Î¾.ğ­[:âˆ‚xâˆ‚yÂ²][index[i]+j]
        âˆ‚Â³ğ­âˆ‚yÂ³[j] = Î¾.ğ­[:âˆ‚yÂ³][index[i]+j]
    end
    return ğ­, âˆ‚ğ­âˆ‚x, âˆ‚ğ­âˆ‚y, âˆ‚Â²ğ­âˆ‚xÂ², âˆ‚Â²ğ­âˆ‚xâˆ‚y, âˆ‚Â²ğ­âˆ‚yÂ², âˆ‚Â³ğ­âˆ‚xÂ³, âˆ‚Â³ğ­âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğ­âˆ‚xâˆ‚yÂ², âˆ‚Â³ğ­âˆ‚yÂ³
end

function getâˆ‡Ì„ğ­(ap::ReproducingKernel,Î¾::SNode)
    ğ­ = ap.ğ­[:âˆ‚1]
    âˆ‚ğ­âˆ‚x = ap.ğ­[:âˆ‚x]
    âˆ‚ğ­âˆ‚y = ap.ğ­[:âˆ‚y]
    âˆ‚ğ­âˆ‚z = ap.ğ­[:âˆ‚z]
    i = Î¾.id
    index = Î¾.index
    for j in 1:length(ap.ğ“’)
        ğ­[j] = Î¾.ğ­[:âˆ‚1][index[i]+j]
        âˆ‚ğ­âˆ‚x[j] = Î¾.ğ­[:âˆ‚Ì„x][index[i]+j]
        âˆ‚ğ­âˆ‚y[j] = haskey(Î¾.ğ­,:âˆ‚Ì„y) ? Î¾.ğ­[:âˆ‚Ì„y][index[i]+j] : 0.0
        âˆ‚ğ­âˆ‚z[j] = haskey(Î¾.ğ­,:âˆ‚Ì„z) ? Î¾.ğ­[:âˆ‚Ì„z][index[i]+j] : 0.0
    end
    return ğ­, âˆ‚ğ­âˆ‚x, âˆ‚ğ­âˆ‚y, âˆ‚ğ­âˆ‚z
end
## RK gradient smoothing
function setâˆ‡Ìƒğ­!(aps::Vector{T}) where T<:ReproducingKernel
    for ap in aps
        setâˆ‡Ìƒğ­!(ap)
    end
end
setâˆ‡Ìƒğ­!(ap::T) where T<:ReproducingKernel{SNode} = setâˆ‡Ìƒğ­!(ap,ap)

function setâˆ‡ÌƒÂ²ğ­!(aps::Vector{T}) where T<:ReproducingKernel
    for ap in aps
        setâˆ‡ÌƒÂ²ğ­!(ap)
    end
end
setâˆ‡ÌƒÂ²ğ­!(ap::T) where T<:ReproducingKernel{SNode} = setâˆ‡ÌƒÂ²ğ­!(ap,ap)

function setâˆ‡Ìƒğ­!(gps::Vector{T},aps::Vector{S}) where {T<:ReproducingKernel,S<:ReproducingKernel}
    if length(gps) â‰  length(aps)
        error("Miss match element numbers")
    else
        for i in 1:length(gps)
            setâˆ‡Ìƒğ­!(gps[i],aps[i])
        end
    end
end

function setâˆ‡ÌƒÂ²ğ­!(gps::Vector{T},aps::Vector{S}) where {T<:ReproducingKernel,S<:ReproducingKernel}
    if length(gps) â‰  length(aps)
        error("Miss match element numbers")
    else
        for i in 1:length(gps)
            setâˆ‡ÌƒÂ²ğ­!(gps[i],aps[i])
        end
    end
end

function setâˆ‡âˆ‡ÌƒÂ²ğ­!(gps::Vector{T},aps::Vector{S}) where {T<:ReproducingKernel,S<:ReproducingKernel}
    if length(gps) â‰  length(aps)
        error("Miss match element numbers")
    else
        for i in 1:length(gps)
            setâˆ‡âˆ‡ÌƒÂ²ğ­!(gps[i],aps[i])
        end
    end
end

function setâˆ‡Ìƒğ­!(as::Vector{T},bs::Vector{S},cs::Vector{R}) where {T<:ReproducingKernel,S<:ReproducingKernel,R<:ReproducingKernel}
    if length(as) â‰  length(bs) || length(bs) â‰  length(cs)
        error("Miss match element numbers")
    else
        for i in 1:length(as)
            setâˆ‡Ìƒğ­!(as[i],bs[i],cs[i])
        end
    end
end
function setâˆ‡Ìƒğ­!(gp::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Seg2},ap::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Seg2}) where {ğ’‘,ğ‘ ,ğœ™}
    nâ‚ =  1.0
    nâ‚‚ = -1.0
    ğ“’ = gp.ğ“’
    ğ“– = gp.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’’(gp,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—š!(gp)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ­âˆ‚x = gp.ğ­[:âˆ‚x]
        fill!(âˆ‚ğ­âˆ‚x,0.0)
        for Î¾ in ap.ğ“–
            w = Î¾.w/2
            wáµ‡ = Î¾.wáµ‡
            náµ‡â‚ = 0.0
            náµ‡â‚ += Î¾.Î¾ ==  1.0 ? nâ‚ : 0.0
            náµ‡â‚ += Î¾.Î¾ == -1.0 ? nâ‚‚ : 0.0
            ğ­ = getğ­(ap,Î¾)
            ğ’’, âˆ‚ğ’’âˆ‚Î¾ = getâˆ‡ğ’’(gp,Î¾)
            Wâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’*náµ‡â‚*wáµ‡ + ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾*nâ‚*w
            for i in 1:length(ğ“’)
                âˆ‚ğ­âˆ‚x[i] += ğ­[i]*Wâ‚
            end
        end
        for i in 1:length(ğ“’)
            Î¾Ì‚.ğ­[:âˆ‚x][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚ğ­âˆ‚x[i]
        end
    end
end

function setâˆ‡Ìƒğ­!(gp::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3},ap::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    xâ‚ = gp.ğ“’[1].x;yâ‚ = gp.ğ“’[1].y
    xâ‚‚ = gp.ğ“’[2].x;yâ‚‚ = gp.ğ“’[2].y
    xâ‚ƒ = gp.ğ“’[3].x;yâ‚ƒ = gp.ğ“’[3].y
    nâ‚â‚ = yâ‚ƒ-yâ‚‚;nâ‚‚â‚ = yâ‚-yâ‚ƒ;nâ‚ƒâ‚ = yâ‚‚-yâ‚
    nâ‚â‚‚ = xâ‚‚-xâ‚ƒ;nâ‚‚â‚‚ = xâ‚ƒ-xâ‚;nâ‚ƒâ‚‚ = xâ‚-xâ‚‚
    ğ“’ = gp.ğ“’
    ğ“– = gp.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚(gp,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—š!(gp)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ­âˆ‚x = gp.ğ­[:âˆ‚x]
        âˆ‚ğ­âˆ‚y = gp.ğ­[:âˆ‚y]
        fill!(âˆ‚ğ­âˆ‚x,0.0)
        fill!(âˆ‚ğ­âˆ‚y,0.0)
        for Î¾ in ap.ğ“–
            w = Î¾.w
            wáµ‡ = Î¾.wáµ‡
            ğ­ = getğ­(ap,Î¾)
            ğ’’, âˆ‚ğ’’âˆ‚Î¾, âˆ‚ğ’’âˆ‚Î· = getâˆ‡ğ’‘â‚(ap,Î¾)
            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            náµ‡â‚ = 0.0;náµ‡â‚‚ = 0.0
            Î¾.Î¾ == 0.0 ? (náµ‡â‚ += nâ‚â‚;náµ‡â‚‚ += nâ‚â‚‚) : nothing
            Î¾.Î· == 0.0 ? (náµ‡â‚ += nâ‚‚â‚;náµ‡â‚‚ += nâ‚‚â‚‚) : nothing
            Î¾.Î¾+Î¾.Î· â‰ˆ 1.0 ? (náµ‡â‚ += nâ‚ƒâ‚;náµ‡â‚‚ += nâ‚ƒâ‚‚) : nothing
            bâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            bâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚
            Wâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*náµ‡â‚*wáµ‡ + bâ‚*w/2
            Wâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*náµ‡â‚‚*wáµ‡ + bâ‚‚*w/2
            for i in 1:length(ğ“’)
                âˆ‚ğ­âˆ‚x[i] += ğ­[i]*Wâ‚
                âˆ‚ğ­âˆ‚y[i] += ğ­[i]*Wâ‚‚
            end
        end
        for i in 1:length(ğ“’)
            Î¾Ì‚.ğ­[:âˆ‚x][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚ğ­âˆ‚x[i]
            Î¾Ì‚.ğ­[:âˆ‚y][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚ğ­âˆ‚y[i]
        end
    end
end

function setâˆ‡ÌƒÂ²ğ­!(gp::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3},ap::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    xâ‚ = gp.ğ“’[1].x;yâ‚ = gp.ğ“’[1].y
    xâ‚‚ = gp.ğ“’[2].x;yâ‚‚ = gp.ğ“’[2].y
    xâ‚ƒ = gp.ğ“’[3].x;yâ‚ƒ = gp.ğ“’[3].y
    ğ´ = getğ´(gp)
    nâ‚â‚ = yâ‚ƒ-yâ‚‚;nâ‚‚â‚ = yâ‚-yâ‚ƒ;nâ‚ƒâ‚ = yâ‚‚-yâ‚
    nâ‚â‚‚ = xâ‚‚-xâ‚ƒ;nâ‚‚â‚‚ = xâ‚ƒ-xâ‚;nâ‚ƒâ‚‚ = xâ‚-xâ‚‚
    sâ‚â‚ = -nâ‚â‚‚;sâ‚‚â‚ = -nâ‚‚â‚‚;sâ‚ƒâ‚ = -nâ‚ƒâ‚‚
    sâ‚â‚‚ =  nâ‚â‚;sâ‚‚â‚‚ =  nâ‚‚â‚;sâ‚ƒâ‚‚ =  nâ‚ƒâ‚
    ğ“’ = gp.ğ“’
    ğ“– = gp.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚‚(gp,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—šâ‚‚!(gp)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚Â²ğ­âˆ‚xÂ² = gp.ğ­[:âˆ‚xÂ²]
        âˆ‚Â²ğ­âˆ‚xâˆ‚y = gp.ğ­[:âˆ‚xâˆ‚y]
        âˆ‚Â²ğ­âˆ‚yÂ² = gp.ğ­[:âˆ‚yÂ²]
        fill!(âˆ‚Â²ğ­âˆ‚xÂ²,0.0)
        fill!(âˆ‚Â²ğ­âˆ‚xâˆ‚y,0.0)
        fill!(âˆ‚Â²ğ­âˆ‚yÂ²,0.0)
        for Î¾ in ap.ğ“–
            w = Î¾.w
            wáµ‡ = Î¾.wáµ‡
            ğ­,âˆ‚ğ­âˆ‚x,âˆ‚ğ­âˆ‚y = getâˆ‡ğ­(ap,Î¾)
            ğ’’, âˆ‚ğ’’âˆ‚Î¾, âˆ‚ğ’’âˆ‚Î·, âˆ‚Â²ğ’’âˆ‚Î¾Â², âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·, âˆ‚Â²ğ’’âˆ‚Î·Â² = getâˆ‡Â²ğ’‘â‚‚(ap,Î¾)
            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾Â²
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·
            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î·Â²

            qâ‚â‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚ + 2*ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚*nâ‚‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚
            qâ‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*(nâ‚â‚*nâ‚‚â‚‚+nâ‚â‚‚*nâ‚‚â‚) + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚‚
            qâ‚‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚*nâ‚â‚‚ + 2*ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚*nâ‚‚â‚‚

            qâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            qâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚

            qâ‚nâ‚ = 0.0;qâ‚‚nâ‚‚ = 0.0;qâ‚nâ‚‚ = 0.0;qâ‚‚nâ‚ = 0.0
            mnâ‚â‚nâ‚ = 0.0;mnâ‚â‚nâ‚‚ = 0.0;mnâ‚â‚‚nâ‚ = 0.0;mnâ‚â‚‚nâ‚‚ = 0.0;mnâ‚‚â‚‚nâ‚ = 0.0;mnâ‚‚â‚‚nâ‚‚ = 0.0
            msâ‚â‚ = 0.0;msâ‚â‚‚ = 0.0;msâ‚‚â‚‚ = 0.0
            Î”msâ‚â‚ = 0.0;Î”msâ‚â‚‚ = 0.0;Î”msâ‚‚â‚‚ = 0.0
            ğ¿â‚Â² = nâ‚â‚^2+nâ‚â‚‚^2
            ğ¿â‚‚Â² = nâ‚‚â‚^2+nâ‚‚â‚‚^2
            ğ¿â‚ƒÂ² = nâ‚ƒâ‚^2+nâ‚ƒâ‚‚^2
            if Î¾.Î¾ == 0.0
                qâ‚nâ‚ += qâ‚*nâ‚â‚
                qâ‚nâ‚‚ += qâ‚*nâ‚â‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚â‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚â‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚‚/ğ¿â‚Â²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                msâ‚â‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*nâ‚â‚*sâ‚â‚/ğ¿â‚Â²
                msâ‚â‚‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*0.5*(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²
                msâ‚‚â‚‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²
                if Î¾.Î· == 0.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚â‚*sâ‚â‚/ğ¿â‚Â²-nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²-nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²-(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²)
                end
            end
            if  Î¾.Î· == 0.0
                qâ‚nâ‚ += qâ‚*nâ‚‚â‚
                qâ‚nâ‚‚ += qâ‚*nâ‚‚â‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚‚â‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚‚â‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                msâ‚â‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²
                msâ‚â‚‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*0.5*(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²
                msâ‚‚â‚‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²
                if Î¾.Î¾+Î¾.Î· â‰ˆ 1.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²-nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²-nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²-(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²)
                end
            end
            if Î¾.Î¾+Î¾.Î· â‰ˆ 1.0
                qâ‚nâ‚ += qâ‚*nâ‚ƒâ‚
                qâ‚nâ‚‚ += qâ‚*nâ‚ƒâ‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚ƒâ‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚ƒâ‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                msâ‚â‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²
                msâ‚â‚‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*0.5*(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²
                msâ‚‚â‚‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                if Î¾.Î¾ == 0.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²-nâ‚â‚*sâ‚â‚/ğ¿â‚Â²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²-nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²-(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²)
                end
            end

            Wâ‚â‚â‚ = mnâ‚â‚nâ‚*wáµ‡
            Wâ‚â‚â‚‚ = mnâ‚â‚nâ‚‚*wáµ‡
            Wâ‚â‚‚â‚ = mnâ‚â‚‚nâ‚*wáµ‡
            Wâ‚â‚‚â‚‚ = mnâ‚â‚‚nâ‚‚*wáµ‡
            Wâ‚‚â‚‚â‚ = mnâ‚‚â‚‚nâ‚*wáµ‡
            Wâ‚‚â‚‚â‚‚ = mnâ‚‚â‚‚nâ‚‚*wáµ‡
            Wâ‚â‚ = (qâ‚â‚*w + 2*(qâ‚nâ‚+msâ‚â‚)*wáµ‡)/4/ğ´ + Î”msâ‚â‚
            Wâ‚â‚‚ = (qâ‚â‚‚*w + (qâ‚nâ‚‚+qâ‚‚nâ‚+2*msâ‚â‚‚)*wáµ‡)/4/ğ´ + Î”msâ‚â‚‚
            Wâ‚‚â‚‚ = (qâ‚‚â‚‚*w + 2*(qâ‚‚nâ‚‚+msâ‚‚â‚‚)*wáµ‡)/4/ğ´ + Î”msâ‚‚â‚‚
            for i in 1:length(ğ“’)
                âˆ‚Â²ğ­âˆ‚xÂ²[i] += ğ­[i]*Wâ‚â‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚â‚‚
                âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += ğ­[i]*Wâ‚â‚‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚‚â‚‚
                âˆ‚Â²ğ­âˆ‚yÂ²[i] += ğ­[i]*Wâ‚‚â‚‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚‚â‚‚â‚‚
            end
        end
        for i in 1:length(ğ“’)
            Î¾Ì‚.ğ­[:âˆ‚xÂ²][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚Â²ğ­âˆ‚xÂ²[i]
            Î¾Ì‚.ğ­[:âˆ‚xâˆ‚y][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]
            Î¾Ì‚.ğ­[:âˆ‚yÂ²][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚Â²ğ­âˆ‚yÂ²[i]
        end
    end
end

function setâˆ‡âˆ‡ÌƒÂ²ğ­!(gp::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3},ap::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    xâ‚ = ap.ğ“’[1].x;yâ‚ = ap.ğ“’[1].y
    xâ‚‚ = ap.ğ“’[2].x;yâ‚‚ = ap.ğ“’[2].y
    xâ‚ƒ = ap.ğ“’[3].x;yâ‚ƒ = ap.ğ“’[3].y
    ğ´ = getğ´(ap)
    nâ‚â‚ = yâ‚ƒ-yâ‚‚;nâ‚‚â‚ = yâ‚-yâ‚ƒ;nâ‚ƒâ‚ = yâ‚‚-yâ‚
    nâ‚â‚‚ = xâ‚‚-xâ‚ƒ;nâ‚‚â‚‚ = xâ‚ƒ-xâ‚;nâ‚ƒâ‚‚ = xâ‚-xâ‚‚
    sâ‚â‚ = -nâ‚â‚‚;sâ‚‚â‚ = -nâ‚‚â‚‚;sâ‚ƒâ‚ = -nâ‚ƒâ‚‚
    sâ‚â‚‚ =  nâ‚â‚;sâ‚‚â‚‚ =  nâ‚‚â‚;sâ‚ƒâ‚‚ =  nâ‚ƒâ‚
    ğ“’ = gp.ğ“’
    ğ“– = gp.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚,âˆ‚ğ’’Ì‚âˆ‚Î¾,âˆ‚ğ’’Ì‚âˆ‚Î· = getâˆ‡ğ’‘â‚‚(gp,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—šâ‚‚!(gp)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ = âˆ‚ğ’’Ì‚âˆ‚Î¾*ğ—šâ»Â¹
        âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ = âˆ‚ğ’’Ì‚âˆ‚Î·*ğ—šâ»Â¹
        âˆ‚Â²ğ­âˆ‚xÂ² = gp.ğ­[:âˆ‚xÂ²]
        âˆ‚Â²ğ­âˆ‚xâˆ‚y = gp.ğ­[:âˆ‚xâˆ‚y]
        âˆ‚Â²ğ­âˆ‚yÂ² = gp.ğ­[:âˆ‚yÂ²]
        âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x = gp.ğ­[:âˆ‚xÂ²âˆ‚x]
        âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y = gp.ğ­[:âˆ‚xÂ²âˆ‚y]
        âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x = gp.ğ­[:âˆ‚xâˆ‚yâˆ‚x]
        âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y = gp.ğ­[:âˆ‚xâˆ‚yâˆ‚y]
        âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x = gp.ğ­[:âˆ‚yÂ²âˆ‚x]
        âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y = gp.ğ­[:âˆ‚yÂ²âˆ‚y]
        fill!(âˆ‚Â²ğ­âˆ‚xÂ²,0.0)
        fill!(âˆ‚Â²ğ­âˆ‚xâˆ‚y,0.0)
        fill!(âˆ‚Â²ğ­âˆ‚yÂ²,0.0)
        fill!(âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x,0.0)
        fill!(âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y,0.0)
        fill!(âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x,0.0)
        fill!(âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y,0.0)
        fill!(âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x,0.0)
        fill!(âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y,0.0)
        for Î¾ in ap.ğ“–
            w = Î¾.w
            wáµ‡ = Î¾.wáµ‡
            ğ­,âˆ‚ğ­âˆ‚x,âˆ‚ğ­âˆ‚y = getâˆ‡ğ­(ap,Î¾)
            ğ’’, âˆ‚ğ’’âˆ‚Î¾, âˆ‚ğ’’âˆ‚Î·, âˆ‚Â²ğ’’âˆ‚Î¾Â², âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·, âˆ‚Â²ğ’’âˆ‚Î·Â² = getâˆ‡Â²ğ’‘â‚‚(ap,Î¾)

            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ =  ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*ğ’’
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*ğ’’
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’*nâ‚‚â‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ğ’’*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚

            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚‚â‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚‚â‚‚

            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚

            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚‚â‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â² =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚‚â‚‚

            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚‚â‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î· =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚‚â‚‚

            ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² = ğ’’Ì‚áµ€ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î·Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î·Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚Â²ğ’’âˆ‚Î·Â²
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚â‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â² =  âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚â‚‚+âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚

            qâ‚â‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚ + 2*ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚*nâ‚‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚
            âˆ‚qâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚ + 2*âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚*nâ‚‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚
            âˆ‚qâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚ + 2*âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚*nâ‚‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚

            qâ‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*(nâ‚â‚*nâ‚‚â‚‚+nâ‚â‚‚*nâ‚‚â‚) + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚‚
            âˆ‚qâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*(nâ‚â‚*nâ‚‚â‚‚+nâ‚â‚‚*nâ‚‚â‚) + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚‚
            âˆ‚qâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*(nâ‚â‚*nâ‚‚â‚‚+nâ‚â‚‚*nâ‚‚â‚) + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚*nâ‚‚â‚‚

            qâ‚‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚*nâ‚â‚‚ + 2*ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚*nâ‚‚â‚‚
            âˆ‚qâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚*nâ‚â‚‚ + 2*âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚*nâ‚‚â‚‚
            âˆ‚qâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾Â²*nâ‚â‚‚*nâ‚â‚‚ + 2*âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î¾âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚Â²ğ’’âˆ‚Î·Â²*nâ‚‚â‚‚*nâ‚‚â‚‚

            qâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            âˆ‚qâ‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            âˆ‚qâ‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚
            qâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + ğ’’Ì‚áµ€ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚
            âˆ‚qâ‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚
            âˆ‚qâ‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚

            qâ‚nâ‚ = 0.0;qâ‚‚nâ‚‚ = 0.0;qâ‚nâ‚‚ = 0.0;qâ‚‚nâ‚ = 0.0
            âˆ‚qâ‚âˆ‚xnâ‚ = 0.0;âˆ‚qâ‚‚âˆ‚xnâ‚‚ = 0.0;âˆ‚qâ‚âˆ‚xnâ‚‚ = 0.0;âˆ‚qâ‚‚âˆ‚xnâ‚ = 0.0
            âˆ‚qâ‚âˆ‚ynâ‚ = 0.0;âˆ‚qâ‚‚âˆ‚ynâ‚‚ = 0.0;âˆ‚qâ‚âˆ‚ynâ‚‚ = 0.0;âˆ‚qâ‚‚âˆ‚ynâ‚ = 0.0
            mnâ‚â‚nâ‚ = 0.0;mnâ‚â‚nâ‚‚ = 0.0;mnâ‚â‚‚nâ‚ = 0.0;mnâ‚â‚‚nâ‚‚ = 0.0;mnâ‚‚â‚‚nâ‚ = 0.0;mnâ‚‚â‚‚nâ‚‚ = 0.0
            âˆ‚mnâ‚â‚âˆ‚xnâ‚ = 0.0;âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ = 0.0;âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ = 0.0;âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ = 0.0;âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ = 0.0;âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ = 0.0
            âˆ‚mnâ‚â‚âˆ‚ynâ‚ = 0.0;âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ = 0.0;âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ = 0.0;âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ = 0.0;âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ = 0.0;âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ = 0.0
            msâ‚â‚ = 0.0;msâ‚â‚‚ = 0.0;msâ‚‚â‚‚ = 0.0
            âˆ‚msâ‚â‚âˆ‚x = 0.0;âˆ‚msâ‚â‚‚âˆ‚x = 0.0;âˆ‚msâ‚‚â‚‚âˆ‚x = 0.0
            âˆ‚msâ‚â‚âˆ‚y = 0.0;âˆ‚msâ‚â‚‚âˆ‚y = 0.0;âˆ‚msâ‚‚â‚‚âˆ‚y = 0.0
            Î”msâ‚â‚ = 0.0;Î”msâ‚â‚‚ = 0.0;Î”msâ‚‚â‚‚ = 0.0
            Î”âˆ‚msâ‚â‚âˆ‚x = 0.0;Î”âˆ‚msâ‚â‚‚âˆ‚x = 0.0;Î”âˆ‚msâ‚‚â‚‚âˆ‚x = 0.0
            Î”âˆ‚msâ‚â‚âˆ‚y = 0.0;Î”âˆ‚msâ‚â‚‚âˆ‚y = 0.0;Î”âˆ‚msâ‚‚â‚‚âˆ‚y = 0.0
            ğ¿â‚Â² = nâ‚â‚^2+nâ‚â‚‚^2
            ğ¿â‚‚Â² = nâ‚‚â‚^2+nâ‚‚â‚‚^2
            ğ¿â‚ƒÂ² = nâ‚ƒâ‚^2+nâ‚ƒâ‚‚^2
            if Î¾.Î¾ == 0.0
                qâ‚nâ‚ += qâ‚*nâ‚â‚
                âˆ‚qâ‚âˆ‚xnâ‚ += âˆ‚qâ‚âˆ‚x*nâ‚â‚
                âˆ‚qâ‚âˆ‚ynâ‚ += âˆ‚qâ‚âˆ‚y*nâ‚â‚
                qâ‚nâ‚‚ += qâ‚*nâ‚â‚‚
                âˆ‚qâ‚âˆ‚xnâ‚‚ += âˆ‚qâ‚âˆ‚x*nâ‚â‚‚
                âˆ‚qâ‚âˆ‚ynâ‚‚ += âˆ‚qâ‚âˆ‚y*nâ‚â‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚â‚
                âˆ‚qâ‚‚âˆ‚xnâ‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚â‚
                âˆ‚qâ‚‚âˆ‚ynâ‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚â‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚â‚‚
                âˆ‚qâ‚‚âˆ‚xnâ‚‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚â‚‚
                âˆ‚qâ‚‚âˆ‚ynâ‚‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚â‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚*nâ‚â‚‚/ğ¿â‚Â²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚/ğ¿â‚Â²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚â‚‚*nâ‚â‚‚*nâ‚â‚‚/ğ¿â‚Â²
                msâ‚â‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*nâ‚â‚*sâ‚â‚/ğ¿â‚Â²
                âˆ‚msâ‚â‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚â‚‚)*nâ‚â‚*sâ‚â‚/ğ¿â‚Â²
                âˆ‚msâ‚â‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚â‚‚)*nâ‚â‚*sâ‚â‚/ğ¿â‚Â²
                msâ‚â‚‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*0.5*(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²
                âˆ‚msâ‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚â‚‚)*0.5*(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²
                âˆ‚msâ‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚â‚‚)*0.5*(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²
                msâ‚‚â‚‚ += (qâ‚*sâ‚â‚+qâ‚‚*sâ‚â‚‚)*nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²
                âˆ‚msâ‚‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚â‚‚)*nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²
                âˆ‚msâ‚‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚â‚‚)*nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²
                if Î¾.Î· == 0.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚â‚*sâ‚â‚/ğ¿â‚Â²-nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚â‚*sâ‚â‚/ğ¿â‚Â²-nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚â‚*sâ‚â‚/ğ¿â‚Â²-nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²-nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²-nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²-nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²-(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*0.5*((nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²-(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*0.5*((nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²-(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²)
                end
            end
            if  Î¾.Î· == 0.0
                qâ‚nâ‚ += qâ‚*nâ‚‚â‚
                âˆ‚qâ‚âˆ‚xnâ‚ += âˆ‚qâ‚âˆ‚x*nâ‚‚â‚
                âˆ‚qâ‚âˆ‚ynâ‚ += âˆ‚qâ‚âˆ‚y*nâ‚‚â‚
                qâ‚nâ‚‚ += qâ‚*nâ‚‚â‚‚
                âˆ‚qâ‚âˆ‚xnâ‚‚ += âˆ‚qâ‚âˆ‚x*nâ‚‚â‚‚
                âˆ‚qâ‚âˆ‚ynâ‚‚ += âˆ‚qâ‚âˆ‚y*nâ‚‚â‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚‚â‚
                âˆ‚qâ‚‚âˆ‚xnâ‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚‚â‚
                âˆ‚qâ‚‚âˆ‚ynâ‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚‚â‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚‚â‚‚
                âˆ‚qâ‚‚âˆ‚xnâ‚‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚‚â‚‚
                âˆ‚qâ‚‚âˆ‚ynâ‚‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚‚â‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚/ğ¿â‚‚Â²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚‚â‚‚*nâ‚‚â‚‚*nâ‚‚â‚‚/ğ¿â‚‚Â²
                msâ‚â‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚msâ‚â‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚â‚‚)*nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²
                âˆ‚msâ‚â‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚â‚‚)*nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²
                msâ‚â‚‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*0.5*(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²
                âˆ‚msâ‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚â‚‚)*0.5*(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²
                âˆ‚msâ‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚â‚‚)*0.5*(nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²
                msâ‚‚â‚‚ += (qâ‚*sâ‚‚â‚+qâ‚‚*sâ‚‚â‚‚)*nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚msâ‚‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚x*sâ‚‚â‚‚)*nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²
                âˆ‚msâ‚‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚‚â‚+âˆ‚qâ‚‚âˆ‚y*sâ‚‚â‚‚)*nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²
                if Î¾.Î¾+Î¾.Î· â‰ˆ 1.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²-nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²-nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚‚â‚*sâ‚‚â‚/ğ¿â‚‚Â²-nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²-nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²-nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚‚â‚‚*sâ‚‚â‚‚/ğ¿â‚‚Â²-nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²-(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*0.5*((nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²-(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*0.5*((nâ‚‚â‚*sâ‚‚â‚‚+nâ‚‚â‚‚*sâ‚‚â‚)/ğ¿â‚‚Â²-(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²)
                end
            end
            if Î¾.Î¾+Î¾.Î· â‰ˆ 1.0
                qâ‚nâ‚ += qâ‚*nâ‚ƒâ‚
                âˆ‚qâ‚âˆ‚xnâ‚ += âˆ‚qâ‚âˆ‚x*nâ‚ƒâ‚
                âˆ‚qâ‚âˆ‚ynâ‚ += âˆ‚qâ‚âˆ‚y*nâ‚ƒâ‚
                qâ‚nâ‚‚ += qâ‚*nâ‚ƒâ‚‚
                âˆ‚qâ‚âˆ‚xnâ‚‚ += âˆ‚qâ‚âˆ‚x*nâ‚ƒâ‚‚
                âˆ‚qâ‚âˆ‚ynâ‚‚ += âˆ‚qâ‚âˆ‚y*nâ‚ƒâ‚‚
                qâ‚‚nâ‚ += qâ‚‚*nâ‚ƒâ‚
                âˆ‚qâ‚‚âˆ‚xnâ‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚ƒâ‚
                âˆ‚qâ‚‚âˆ‚ynâ‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚ƒâ‚
                qâ‚‚nâ‚‚ += qâ‚‚*nâ‚ƒâ‚‚
                âˆ‚qâ‚‚âˆ‚xnâ‚‚ += âˆ‚qâ‚‚âˆ‚x*nâ‚ƒâ‚‚
                âˆ‚qâ‚‚âˆ‚ynâ‚‚ += âˆ‚qâ‚‚âˆ‚y*nâ‚ƒâ‚‚
                mnâ‚â‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚â‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                mnâ‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                mnâ‚‚â‚‚nâ‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚/ğ¿â‚ƒÂ²
                mnâ‚‚â‚‚nâ‚‚ += ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚ += âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚*nâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                msâ‚â‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚msâ‚â‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚ƒâ‚‚)*nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²
                âˆ‚msâ‚â‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚ƒâ‚‚)*nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²
                msâ‚â‚‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*0.5*(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²
                âˆ‚msâ‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚ƒâ‚‚)*0.5*(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²
                âˆ‚msâ‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚ƒâ‚‚)*0.5*(nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²
                msâ‚‚â‚‚ += (qâ‚*sâ‚ƒâ‚+qâ‚‚*sâ‚ƒâ‚‚)*nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚msâ‚‚â‚‚âˆ‚x += (âˆ‚qâ‚âˆ‚x*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚x*sâ‚ƒâ‚‚)*nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                âˆ‚msâ‚‚â‚‚âˆ‚y += (âˆ‚qâ‚âˆ‚y*sâ‚ƒâ‚+âˆ‚qâ‚‚âˆ‚y*sâ‚ƒâ‚‚)*nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²
                if Î¾.Î¾ == 0.0
                    Î”msâ‚â‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²-nâ‚â‚*sâ‚â‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²-nâ‚â‚*sâ‚â‚/ğ¿â‚ƒÂ²)
                    Î”âˆ‚msâ‚â‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚*sâ‚ƒâ‚/ğ¿â‚ƒÂ²-nâ‚â‚*sâ‚â‚/ğ¿â‚ƒÂ²)
                    Î”msâ‚‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²-nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²-nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*(nâ‚ƒâ‚‚*sâ‚ƒâ‚‚/ğ¿â‚ƒÂ²-nâ‚â‚‚*sâ‚â‚‚/ğ¿â‚Â²)
                    Î”msâ‚â‚‚ =  ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*0.5*((nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²-(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹ğ’’*0.5*((nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²-(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²)
                    Î”âˆ‚msâ‚â‚‚âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹ğ’’*0.5*((nâ‚ƒâ‚*sâ‚ƒâ‚‚+nâ‚ƒâ‚‚*sâ‚ƒâ‚)/ğ¿â‚ƒÂ²-(nâ‚â‚*sâ‚â‚‚+nâ‚â‚‚*sâ‚â‚)/ğ¿â‚Â²)
                end
            end

            Wâ‚â‚â‚ = mnâ‚â‚nâ‚*wáµ‡
            âˆ‚Wâ‚â‚â‚âˆ‚x = âˆ‚mnâ‚â‚âˆ‚xnâ‚*wáµ‡
            âˆ‚Wâ‚â‚â‚âˆ‚y = âˆ‚mnâ‚â‚âˆ‚ynâ‚*wáµ‡
            Wâ‚â‚â‚‚ = mnâ‚â‚nâ‚‚*wáµ‡
            âˆ‚Wâ‚â‚â‚‚âˆ‚x = âˆ‚mnâ‚â‚âˆ‚xnâ‚‚*wáµ‡
            âˆ‚Wâ‚â‚â‚‚âˆ‚y = âˆ‚mnâ‚â‚âˆ‚ynâ‚‚*wáµ‡
            Wâ‚â‚‚â‚ = mnâ‚â‚‚nâ‚*wáµ‡
            âˆ‚Wâ‚â‚‚â‚âˆ‚x = âˆ‚mnâ‚â‚‚âˆ‚xnâ‚*wáµ‡
            âˆ‚Wâ‚â‚‚â‚âˆ‚y = âˆ‚mnâ‚â‚‚âˆ‚ynâ‚*wáµ‡
            Wâ‚â‚‚â‚‚ = mnâ‚â‚‚nâ‚‚*wáµ‡
            âˆ‚Wâ‚â‚‚â‚‚âˆ‚x = âˆ‚mnâ‚â‚‚âˆ‚xnâ‚‚*wáµ‡
            âˆ‚Wâ‚â‚‚â‚‚âˆ‚y = âˆ‚mnâ‚â‚‚âˆ‚ynâ‚‚*wáµ‡
            Wâ‚‚â‚‚â‚ = mnâ‚‚â‚‚nâ‚*wáµ‡
            âˆ‚Wâ‚‚â‚‚â‚âˆ‚x = âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚*wáµ‡
            âˆ‚Wâ‚‚â‚‚â‚âˆ‚y = âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚*wáµ‡
            Wâ‚‚â‚‚â‚‚ = mnâ‚‚â‚‚nâ‚‚*wáµ‡
            âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚x = âˆ‚mnâ‚‚â‚‚âˆ‚xnâ‚‚*wáµ‡
            âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚y = âˆ‚mnâ‚‚â‚‚âˆ‚ynâ‚‚*wáµ‡
            Wâ‚â‚ = (qâ‚â‚*w + 2*(qâ‚nâ‚+msâ‚â‚)*wáµ‡)/4/ğ´ + Î”msâ‚â‚
            âˆ‚Wâ‚â‚âˆ‚x = (âˆ‚qâ‚â‚âˆ‚x*w + 2*(âˆ‚qâ‚âˆ‚xnâ‚+âˆ‚msâ‚â‚âˆ‚x)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚â‚âˆ‚x
            âˆ‚Wâ‚â‚âˆ‚y = (âˆ‚qâ‚â‚âˆ‚y*w + 2*(âˆ‚qâ‚âˆ‚ynâ‚+âˆ‚msâ‚â‚âˆ‚y)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚â‚âˆ‚y
            Wâ‚â‚‚ = (qâ‚â‚‚*w + (qâ‚nâ‚‚+qâ‚‚nâ‚+2*msâ‚â‚‚)*wáµ‡)/4/ğ´ + Î”msâ‚â‚‚
            âˆ‚Wâ‚â‚‚âˆ‚x = (âˆ‚qâ‚â‚‚âˆ‚x*w + (âˆ‚qâ‚âˆ‚xnâ‚‚+âˆ‚qâ‚‚âˆ‚xnâ‚+2*âˆ‚msâ‚â‚‚âˆ‚x)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚â‚‚âˆ‚x
            âˆ‚Wâ‚â‚‚âˆ‚y = (âˆ‚qâ‚â‚‚âˆ‚y*w + (âˆ‚qâ‚âˆ‚ynâ‚‚+âˆ‚qâ‚‚âˆ‚ynâ‚+2*âˆ‚msâ‚â‚‚âˆ‚y)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚â‚‚âˆ‚y
            Wâ‚‚â‚‚ = (qâ‚‚â‚‚*w + 2*(qâ‚‚nâ‚‚+msâ‚‚â‚‚)*wáµ‡)/4/ğ´ + Î”msâ‚‚â‚‚
            âˆ‚Wâ‚‚â‚‚âˆ‚x = (âˆ‚qâ‚‚â‚‚âˆ‚x*w + 2*(âˆ‚qâ‚‚âˆ‚xnâ‚‚+âˆ‚msâ‚‚â‚‚âˆ‚x)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚‚â‚‚âˆ‚x
            âˆ‚Wâ‚‚â‚‚âˆ‚y = (âˆ‚qâ‚‚â‚‚âˆ‚y*w + 2*(âˆ‚qâ‚‚âˆ‚ynâ‚‚+âˆ‚msâ‚‚â‚‚âˆ‚y)*wáµ‡)/4/ğ´ + Î”âˆ‚msâ‚‚â‚‚âˆ‚y
            for i in 1:length(ğ“’)
                âˆ‚Â²ğ­âˆ‚xÂ²[i] += ğ­[i]*Wâ‚â‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚â‚‚
                âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚â‚âˆ‚x + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚â‚‚âˆ‚x
                âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚â‚âˆ‚y + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚â‚‚âˆ‚y
                âˆ‚Â²ğ­âˆ‚xâˆ‚y[i] += ğ­[i]*Wâ‚â‚‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚‚â‚‚
                âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚â‚‚âˆ‚x + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚‚â‚‚âˆ‚x
                âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚â‚‚âˆ‚y + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚â‚‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚â‚‚â‚‚âˆ‚y
                âˆ‚Â²ğ­âˆ‚yÂ²[i] += ğ­[i]*Wâ‚‚â‚‚ + âˆ‚ğ­âˆ‚x[i]*Wâ‚‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚‚â‚‚â‚‚
                âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x[i] += ğ­[i]*âˆ‚Wâ‚‚â‚‚âˆ‚x + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚‚â‚‚â‚âˆ‚x + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚x
                âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y[i] += ğ­[i]*âˆ‚Wâ‚‚â‚‚âˆ‚y + âˆ‚ğ­âˆ‚x[i]*âˆ‚Wâ‚‚â‚‚â‚âˆ‚y + âˆ‚ğ­âˆ‚y[i]*âˆ‚Wâ‚‚â‚‚â‚‚âˆ‚y
            end
        end
        for i in 1:length(ğ“’)
            Î¾Ì‚.ğ­[:âˆ‚xÂ²][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚Â²ğ­âˆ‚xÂ²[i]
            Î¾Ì‚.ğ­[:âˆ‚xÂ²âˆ‚x][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚x[i]
            Î¾Ì‚.ğ­[:âˆ‚xÂ²âˆ‚y][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚âˆ‚Â²ğ­âˆ‚xÂ²âˆ‚y[i]
            Î¾Ì‚.ğ­[:âˆ‚xâˆ‚y][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚Â²ğ­âˆ‚xâˆ‚y[i]
            Î¾Ì‚.ğ­[:âˆ‚xâˆ‚yâˆ‚x][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚x[i]
            Î¾Ì‚.ğ­[:âˆ‚xâˆ‚yâˆ‚y][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚âˆ‚Â²ğ­âˆ‚xâˆ‚yâˆ‚y[i]
            Î¾Ì‚.ğ­[:âˆ‚yÂ²][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚Â²ğ­âˆ‚yÂ²[i]
            Î¾Ì‚.ğ­[:âˆ‚yÂ²âˆ‚x][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚x[i]
            Î¾Ì‚.ğ­[:âˆ‚yÂ²âˆ‚y][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚âˆ‚Â²ğ­âˆ‚yÂ²âˆ‚y[i]
        end
    end
end

function setâˆ‡Ì„ğ­!(aps::Vector{T}) where T<:AbstractElement
    setğ­!(aps)
    for ap in aps
        setâˆ‡Ì„ğ­!(ap)
    end
end

function setâˆ‡Ì„ğ­!(ap::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Seg2}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—š!(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ­âˆ‚x = ap.ğ­[:âˆ‚x]
        fill!(âˆ‚ğ­âˆ‚x,0.0)
        for Î¾ in ap.ğ“–
            w = Î¾.w
            n = Î¾.nâ‚
            ğ­ = getğ­(ap,Î¾)
            ğ’’ = getğ’‘â‚(ap,Î¾)
            Wâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’*n*w
            for i in 1:length(ğ“’)
                âˆ‚ğ­âˆ‚x[i] += ğ­[i]*Wâ‚
            end
        end
        for i in 1:length(ğ“’)
            Î¾Ì‚.ğ­[:âˆ‚Ì„x][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚ğ­âˆ‚x[i]
        end
    end
end

function setâˆ‡Ì„ğ­!(ap::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—š!(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        âˆ‚ğ­âˆ‚x = ap.ğ­[:âˆ‚x]
        âˆ‚ğ­âˆ‚y = ap.ğ­[:âˆ‚y]
        fill!(âˆ‚ğ­âˆ‚x,0.0)
        fill!(âˆ‚ğ­âˆ‚y,0.0)
        for Î¾ in ap.ğ“–
            w = Î¾.w
            nâ‚ = Î¾.nâ‚
            nâ‚‚ = Î¾.nâ‚‚
            ğ­ = getğ­(ap,Î¾)
            ğ’’ = getğ’‘â‚(ap,Î¾)
            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ = ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            Wâ‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*w
            Wâ‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚*w
            for i in 1:length(ğ“’)
                âˆ‚ğ­âˆ‚x[i] += ğ­[i]*Wâ‚
                âˆ‚ğ­âˆ‚y[i] += ğ­[i]*Wâ‚‚
            end
        end
        for i in 1:length(ğ“’)
            Î¾Ì‚.ğ­[:âˆ‚Ì„x][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚ğ­âˆ‚x[i]
            Î¾Ì‚.ğ­[:âˆ‚Ì„y][Î¾Ì‚.index[Î¾Ì‚.id]+i] = âˆ‚ğ­âˆ‚y[i]
        end
    end
end

function setâˆ‡Ì„Â²ğ­!(ap::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    for Î¾Ì‚ in ğ“–
        ğ’’Ì‚ = getğ’‘â‚‚(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—šâ‚‚!(ap)
        ğ’’Ì‚áµ€ğ—šâ»Â¹ = ğ’’Ì‚*ğ—šâ»Â¹
        Mâ‚â‚ = ap.ğ­[:Mâ‚â‚]
        Mâ‚â‚‚ = ap.ğ­[:Mâ‚â‚‚]
        Mâ‚‚â‚‚ = ap.ğ­[:Mâ‚‚â‚‚]
        fill!(Mâ‚â‚,0.0)
        fill!(Mâ‚â‚‚,0.0)
        fill!(Mâ‚‚â‚‚,0.0)
        for Î¾ in ğ“–
            w = Î¾.w
            nâ‚ = Î¾.nâ‚
            nâ‚‚ = Î¾.nâ‚‚
            ğ¿Â² = Î¾.ğ¿^2
            _,âˆ‚ğ­âˆ‚x,âˆ‚ğ­âˆ‚y = getâˆ‡ğ­(ap,Î¾)
            ğ’’ = getğ’‘â‚‚(ap,Î¾)
            ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’ = ğ’’Ì‚áµ€ğ—šâ»Â¹*ğ’’
            Wâ‚â‚â‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚*w/ğ¿Â²
            Wâ‚â‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚*nâ‚‚*w/ğ¿Â²
            Wâ‚‚â‚‚â‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚*w/ğ¿Â²
            Wâ‚‚â‚‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚‚*nâ‚‚*nâ‚‚*w/ğ¿Â²
            Wâ‚â‚‚â‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚*w/ğ¿Â²
            Wâ‚â‚‚â‚‚ = ğ’’Ì‚áµ€ğ—šâ»Â¹ğ’’*nâ‚*nâ‚‚*nâ‚‚*w/ğ¿Â²
            for i in 1:length(ğ“’)
                Mâ‚â‚[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚â‚‚
                Mâ‚â‚‚[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚â‚‚â‚‚
                Mâ‚‚â‚‚[i] += âˆ‚ğ­âˆ‚x[i]*Wâ‚‚â‚‚â‚ + âˆ‚ğ­âˆ‚y[i]*Wâ‚‚â‚‚â‚‚
            end
        end
        nâ‚ = Î¾Ì‚.nâ‚
        nâ‚‚ = Î¾Ì‚.nâ‚‚
        for i in 1:length(ğ“’)
            Î¾Ì‚.ğ­[:Mâ‚™â‚™][Î¾Ì‚.index[Î¾Ì‚.id]+i] = Mâ‚â‚[i]*nâ‚*nâ‚ + 2*Mâ‚â‚‚[i]*nâ‚*nâ‚‚ + Mâ‚‚â‚‚[i]*nâ‚‚*nâ‚‚
        end
    end
end

function setVÌ„â‚™!(ap::ReproducingKernel{SNode,ğ’‘,ğ‘ ,ğœ™,:Tri3}) where {ğ’‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    xâ‚ = ğ“’[1].x;yâ‚ = ğ“’[1].y
    xâ‚‚ = ğ“’[2].x;yâ‚‚ = ğ“’[2].y
    xâ‚ƒ = ğ“’[3].x;yâ‚ƒ = ğ“’[3].y
    ğ´ = getğ´(gp)
    nâ‚â‚ = yâ‚ƒ-yâ‚‚;nâ‚‚â‚ = yâ‚-yâ‚ƒ;nâ‚ƒâ‚ = yâ‚‚-yâ‚
    nâ‚â‚‚ = xâ‚‚-xâ‚ƒ;nâ‚‚â‚‚ = xâ‚ƒ-xâ‚;nâ‚ƒâ‚‚ = xâ‚-xâ‚‚

    for Î¾Ì‚ in ğ“–
        _,âˆ‚ğ’’Ì‚âˆ‚Î¾,âˆ‚ğ’’Ì‚âˆ‚Î· = getâˆ‡ğ’‘â‚‚(ap,Î¾Ì‚)
        ğ—šâ»Â¹ = calğ—šâ‚‚!(ap)
        âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹ = âˆ‚ğ’’Ì‚âˆ‚Î¾*ğ—šâ»Â¹
        âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹ = âˆ‚ğ’’Ì‚âˆ‚Î·*ğ—šâ»Â¹
        Vâ‚â‚â‚ = ap.ğ­[:Vâ‚â‚â‚]
        Vâ‚â‚â‚‚ = ap.ğ­[:Vâ‚â‚â‚‚]
        Vâ‚â‚‚â‚ = ap.ğ­[:Vâ‚â‚‚â‚]
        Vâ‚â‚‚â‚‚ = ap.ğ­[:Vâ‚â‚‚â‚‚]
        Vâ‚‚â‚â‚ = ap.ğ­[:Vâ‚‚â‚â‚]
        Vâ‚‚â‚â‚‚ = ap.ğ­[:Vâ‚‚â‚â‚‚]
        Vâ‚‚â‚‚â‚ = ap.ğ­[:Vâ‚‚â‚‚â‚]
        Vâ‚‚â‚‚â‚‚ = ap.ğ­[:Vâ‚‚â‚‚â‚‚]
        fill!(Vâ‚â‚â‚,0.0)
        fill!(Vâ‚â‚â‚‚,0.0)
        fill!(Vâ‚â‚‚â‚,0.0)
        fill!(Vâ‚â‚‚â‚‚,0.0)
        fill!(Vâ‚‚â‚â‚,0.0)
        fill!(Vâ‚‚â‚â‚‚,0.0)
        fill!(Vâ‚‚â‚‚â‚,0.0)
        fill!(Vâ‚‚â‚‚â‚‚,0.0)
        for Î¾ in ap.ğ“–
            w = Î¾.w
            nâ‚ = Î¾.nâ‚
            nâ‚‚ = Î¾.nâ‚‚
            sâ‚ = -Î¾.nâ‚‚
            sâ‚‚ = Î¾.nâ‚
            ğ¿Â² = Î¾.ğ¿^2
            ğ­ = getğ­(ap,Î¾)
            _,âˆ‚ğ’’âˆ‚Î¾,âˆ‚ğ’’âˆ‚Î· = getâˆ‡ğ’‘â‚‚(ap,Î¾)
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾ = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î¾
            âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· = âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹*âˆ‚ğ’’âˆ‚Î·
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚*nâ‚â‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· + âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾)*nâ‚â‚*nâ‚‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚*nâ‚‚â‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚â‚*nâ‚‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚*nâ‚‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚*nâ‚‚â‚‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚x = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚*nâ‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚â‚‚*nâ‚‚â‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚*nâ‚‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚*nâ‚‚â‚‚
            âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚y = âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾*nâ‚â‚‚*nâ‚â‚‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚Î¾ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î· + âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î¾)*nâ‚â‚‚*nâ‚‚â‚‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚Î·ğ—šâ»Â¹âˆ‚ğ’’âˆ‚Î·*nâ‚‚â‚‚*nâ‚‚â‚‚
            Wâ‚â‚â‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*nâ‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*sâ‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*sâ‚‚)*sâ‚*nâ‚*w/ğ¿Â²
            Wâ‚â‚â‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*nâ‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*sâ‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*sâ‚‚)*sâ‚*nâ‚*w/ğ¿Â²
            Wâ‚â‚‚â‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*nâ‚‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*sâ‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*sâ‚‚)*sâ‚*nâ‚‚*w/ğ¿Â²
            Wâ‚â‚‚â‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*nâ‚‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*sâ‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*sâ‚‚)*sâ‚*nâ‚‚*w/ğ¿Â²
            Wâ‚‚â‚â‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*nâ‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*sâ‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*sâ‚‚)*sâ‚‚*nâ‚*w/ğ¿Â²
            Wâ‚‚â‚â‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*nâ‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*sâ‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*sâ‚‚)*sâ‚‚*nâ‚*w/ğ¿Â²
            Wâ‚‚â‚‚â‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*nâ‚‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*sâ‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚xğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*sâ‚‚)*sâ‚‚*nâ‚‚*w/ğ¿Â²
            Wâ‚‚â‚‚â‚‚ = âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*nâ‚‚ + (âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚x*sâ‚ + âˆ‚ğ’’Ì‚áµ€âˆ‚yğ—šâ»Â¹âˆ‚ğ’’âˆ‚y*sâ‚‚)*sâ‚‚*nâ‚‚*w/ğ¿Â²
            for i in 1:length(ğ“’)
                Vâ‚â‚â‚[i] += ğ­[i]*Wâ‚â‚â‚
                Vâ‚â‚â‚‚[i] += ğ­[i]*Wâ‚â‚â‚‚
                Vâ‚â‚‚â‚[i] += ğ­[i]*Wâ‚â‚‚â‚
                Vâ‚â‚‚â‚‚[i] += ğ­[i]*Wâ‚â‚‚â‚‚
                Vâ‚‚â‚â‚[i] += ğ­[i]*Wâ‚‚â‚â‚
                Vâ‚‚â‚â‚‚[i] += ğ­[i]*Wâ‚‚â‚â‚‚
                Vâ‚‚â‚‚â‚[i] += ğ­[i]*Wâ‚‚â‚‚â‚
                Vâ‚‚â‚‚â‚‚[i] += ğ­[i]*Wâ‚‚â‚‚â‚‚
            end
        end
        nâ‚ = Î¾Ì‚.nâ‚
        nâ‚‚ = Î¾Ì‚.nâ‚‚
        sâ‚ = -Î¾Ì‚.nâ‚‚
        sâ‚‚ = Î¾Ì‚.nâ‚
        for i in 1:length(ğ“’)
            Î¾Ì‚.ğ­[:Vâ‚™][Î¾Ì‚.index[Î¾Ì‚.id]+i] = Vâ‚â‚â‚[i]*nâ‚ + Vâ‚â‚‚â‚‚[i]*nâ‚ + Vâ‚‚â‚â‚[i]*nâ‚‚ + Vâ‚‚â‚‚â‚‚[i]*nâ‚‚ + (Vâ‚â‚â‚*sâ‚+Vâ‚â‚â‚‚*sâ‚‚)*sâ‚*nâ‚ + (Vâ‚â‚‚â‚*sâ‚+Vâ‚â‚‚â‚‚*sâ‚‚)*sâ‚*nâ‚‚ + (Vâ‚‚â‚â‚*sâ‚+Vâ‚‚â‚â‚‚*sâ‚‚)*sâ‚‚*nâ‚ + (Vâ‚‚â‚‚â‚*sâ‚+Vâ‚‚â‚‚â‚‚*sâ‚‚)*sâ‚‚*nâ‚‚
        end
    end
end
