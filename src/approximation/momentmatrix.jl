
struct SymMat
    n::Int
    m::Vector{Float64}
end
SymMat(n::Int) = SymMat(n,zeros(Int(n*(n+1)/2)))

@inline function getindex(A::SymMat,i::Int,j::Int)
    i > j ? A.m[Int(j+i*(i-1)/2)] : A.m[Int(i+j*(j-1)/2)]
end

@inline function setindex!(A::SymMat,val::Float64,i::Int,j::Int)
    i > j ? A.m[Int(j+i*(i-1)/2)] = val : A.m[Int(i+j*(j-1)/2)] = val
end
@inline function setindex!(A::SymMat,val::Float64,i::Int)
    A.m[i] = val
end

@inline *(A::SymMat,v::NTuple{N,Float64}) where N = sum(A[1,i]*v[i] for i in 1:N)
@inline function *(v::NTuple{N,Float64},A::SymMat) where N
    for j in 1:N
        A[1,j] = sum(v[i]*A[i,j] for i in 1:N)
    end
    return A
end
@inline function -(A::SymMat)
    A.m .= .-A.m
    return A
end
@inline fill!(A::SymMat,val::Float64) = fill!(A.m,val)
function inverse!(A::SymMat)
    n = A.n
    for i in 1:n
        A[i,i] = 1.0/A[i,i]
        for j in i+1:n
            A[i,j] = - sum(A[i,k]*A[k,j] for k in i:j-1)/A[j,j]
        end
    end
    return A
end

function UUáµ€!(A::SymMat)
    n = A.n
    for i in 1:n
        for j in 1:i
            A[i,j] = sum(A[i,k]*A[k,j] for k in i:n)
        end
    end
    return A
end

function Uáµ€AU!(A::SymMat,U::SymMat)
    n = A.n
    for i in n:-1:1
        for j in n:-1:i
            A[i,j] = sum(U[k,i]*A[k,l]*U[l,j] for k in 1:i for l in 1:j)
        end
    end
    return A
end

function UAUáµ€!(A::SymMat,U::SymMat)
    n = A.n
    for i in 1:n
        for j in i:n
            A[i,j] = sum(U[i,k]*A[k,l]*U[j,l] for k in i:n for l in j:n)
        end
    end
    return A
end

function UUáµ€AUUáµ€!(A::SymMat,U::SymMat)
    Uáµ€AU!(A,U)
    UAUáµ€!(A,U)
    return A
end

function cholesky!(A::SymMat)
    n = A.n
    for i in 1:n
        for k in 1:i-1
            A[i,i] -= A[k,i]^2
        end
        A[i,i] = A[i,i]^0.5
        for j in i+1:n
            for k in 1:i-1
                A[i,j] -= A[k,i]A[k,j]
            end
            A[i,j] = A[i,j]/A[i,i]
        end
    end
    return A
end

function getğ— (ap::ReproducingKernel,s::Symbol)
    n = getğ‘›ğ’‘(ap)
    data = getfield(ap.ğ“–[1],:data)
    fill!(data[s][2],0.)
    return SymMat(n,data[s][2])
end
function getğ—š(ap::ReproducingKernel,s::Symbol)
    n = getğ‘›ğ’‘â‚(ap)
    data = getfield(ap.ğ“–[1],:data)
    fill!(data[s][2],0.)
    return SymMat(n,data[s][2])
end

function calğ— â‚•â‚â‚€!(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        r = ((x.x - xáµ¢.x)^2 + (x.x - xáµ¢.x)^2 + (x.x - xáµ¢.x)^2)^0.5
        if r < xáµ¢.s
            mâ‚€ = xáµ¢.mâ‚€
            ğ’‘ = getğ’‘(ap,xáµ¢)
            for I in 1:n
                for J in 1:I
                    ğ— [I,J] += mâ‚€*ğ’‘[I]*ğ’‘[J]
                end
            end
        end
    end
    cholesky!(ğ— )
    inverse!(ğ— )
    UUáµ€!(ğ— )
    return ğ— 
end

function calğ— â‚•â‚â‚!(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        r = ((x.x - xáµ¢.x)^2 + (x.x - xáµ¢.x)^2 + (x.x - xáµ¢.x)^2)^0.5
        if r < xáµ¢.s
            mâ‚€ = xáµ¢.mâ‚€
            mâ‚ = xáµ¢.mâ‚
            ğ’‘,âˆ‚ğ’‘âˆ‚x = getâˆ‡â‚ğ’‘(ap,xáµ¢)
            for I in 1:n
                for J in 1:I
                    ğ— [I,J] += mâ‚€*ğ’‘[I]*ğ’‘[J]
                            + mâ‚*(âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J])
                end
            end
        end
    end
    cholesky!(ğ— )
    inverse!(ğ— )
    UUáµ€!(ğ— )
    return ğ— 
end

function calğ— â‚•â‚‚!(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        r = ((x.x - xáµ¢.x)^2 + (x.x - xáµ¢.x)^2 + (x.x - xáµ¢.x)^2)^0.5
        if r < xáµ¢.s
            mâ‚€ = xáµ¢.mâ‚€
            mâ‚ = xáµ¢.mâ‚
            mâ‚‚ = xáµ¢.mâ‚‚
            ğ’‘,âˆ‚ğ’‘âˆ‚x,âˆ‚ğ’‘âˆ‚y = getâˆ‡â‚‚ğ’‘(ap,xáµ¢)
            for I in 1:n
                for J in 1:I
                    ğ— [I,J] += mâ‚€*ğ’‘[I]*ğ’‘[J]
                            + mâ‚*(âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J])
                            + mâ‚‚*(âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J])
                end
            end
        end
    end
    cholesky!(ğ— )
    inverse!(ğ— )
    UUáµ€!(ğ— )
    return ğ— 
end

function calğ— !(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        Î”x = x - xáµ¢
        ğ’‘ = getğ’‘(ap,Î”x)
        ğœ™ = getğœ™(ap,xáµ¢,Î”x)
        for I in 1:n
            for J in 1:I
                ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
            end
        end
    end
    cholesky!(ğ— )
    inverse!(ğ— )
    UUáµ€!(ğ— )
    return ğ— 
end

function calâˆ‡â‚ğ— !(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        Î”x = x - xáµ¢
        ğ’‘, âˆ‚ğ’‘âˆ‚x = getâˆ‡ğ’‘(ap,Î”x)
        ğœ™, âˆ‚ğœ™âˆ‚x = getâˆ‡ğœ™(ap,xáµ¢,Î”x)
        for I in 1:n
            for J in 1:I
                ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
            end
        end
    end
    cholesky!(ğ— )
    U = inverse!(ğ— )
    âˆ‚ğ— â»Â¹âˆ‚x = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚x,U)
    ğ— â»Â¹ = UUáµ€!(U)
    return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x
end

function calâˆ‡â‚‚ğ— !(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
    âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        Î”x = x - xáµ¢
        ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y = getâˆ‡ğ’‘(ap,Î”x)
        ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y = getâˆ‡ğœ™(ap,xáµ¢,Î”x)
        for I in 1:n
            for J in 1:I
                ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]
            end
        end
    end
    cholesky!(ğ— )
    U = inverse!(ğ— )
    âˆ‚ğ— â»Â¹âˆ‚x = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚x,U)
    âˆ‚ğ— â»Â¹âˆ‚y = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚y,U)
    ğ— â»Â¹ = UUáµ€!(U)
    return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y
end

function calâˆ‡ğ— !(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
    âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
    âˆ‚ğ— âˆ‚z = getğ— (ap,:âˆ‚ğ— âˆ‚z)
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        Î”x = x - xáµ¢
        ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚ğ’‘âˆ‚z = getâˆ‡ğ’‘(ap,Î”x)
        ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚ğœ™âˆ‚z = getâˆ‡ğœ™(ap,xáµ¢,Î”x)
        for I in 1:n
            for J in 1:I
                ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]
                âˆ‚ğ— âˆ‚z[I,J] += âˆ‚ğœ™âˆ‚z*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J]
            end
        end
    end
    cholesky!(ğ— )
    U = inverse!(ğ— )
    âˆ‚ğ— â»Â¹âˆ‚x = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚x,U)
    âˆ‚ğ— â»Â¹âˆ‚y = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚y,U)
    âˆ‚ğ— â»Â¹âˆ‚z = - UUáµ€AUUáµ€!(âˆ‚ğ— âˆ‚z,U)
    ğ— â»Â¹ = UUáµ€!(U)
    return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y, âˆ‚ğ— â»Â¹âˆ‚z
end

function calâˆ‡Â²â‚‚ğ— !(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
    âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
    âˆ‚Â²ğ— âˆ‚xÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xÂ²)
    âˆ‚Â²ğ— âˆ‚yÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚yÂ²)
    âˆ‚Â²ğ— âˆ‚xâˆ‚y = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xâˆ‚y)
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        Î”x = x - xáµ¢
        ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ² = getâˆ‡Â²ğ’‘(ap,Î”x)
        ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ² = getâˆ‡Â²ğœ™(ap,xáµ¢,Î”x)
        for I in 1:n
            for J in 1:I
                ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]
                âˆ‚Â²ğ— âˆ‚xÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J]
                âˆ‚Â²ğ— âˆ‚yÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J]
                âˆ‚Â²ğ— âˆ‚xâˆ‚y[I,J] += âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J]
            end
        end
    end
    cholesky!(ğ— )
    U = inverse!(ğ— )
    Uáµ€âˆ‚ğ— âˆ‚xU = Uáµ€AU!(âˆ‚ğ— âˆ‚x,U)
    Uáµ€âˆ‚ğ— âˆ‚yU = Uáµ€AU!(âˆ‚ğ— âˆ‚y,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xÂ²,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚yÂ²,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xâˆ‚y,U)
    for i in 1:n
        for j in 1:i
            for k in 1:n
                Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j] + Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
            end
        end
    end

    âˆ‚Â²ğ— â»Â¹âˆ‚xÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚yÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU,U)
    âˆ‚ğ— â»Â¹âˆ‚x = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚xU,U)
    âˆ‚ğ— â»Â¹âˆ‚y = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚yU,U)
    ğ— â»Â¹ = UUáµ€!(U)
    return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚yÂ²
end

function calâˆ‡Â²ğ— !(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
    âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
    âˆ‚ğ— âˆ‚z = getğ— (ap,:âˆ‚ğ— âˆ‚z)
    âˆ‚Â²ğ— âˆ‚xÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xÂ²)
    âˆ‚Â²ğ— âˆ‚yÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚yÂ²)
    âˆ‚Â²ğ— âˆ‚zÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚zÂ²)
    âˆ‚Â²ğ— âˆ‚xâˆ‚y = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xâˆ‚y)
    âˆ‚Â²ğ— âˆ‚xâˆ‚z = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xâˆ‚z)
    âˆ‚Â²ğ— âˆ‚yâˆ‚z = getğ— (ap,:âˆ‚Â²ğ— âˆ‚yâˆ‚z)
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        Î”x = x - xáµ¢
        ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ², âˆ‚ğ’‘âˆ‚z, âˆ‚Â²ğ’‘âˆ‚xâˆ‚z, âˆ‚Â²ğ’‘âˆ‚yâˆ‚z, âˆ‚Â²ğ’‘âˆ‚zÂ² = getâˆ‡Â²ğ’‘(ap,Î”x)
        ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ², âˆ‚ğœ™âˆ‚z, âˆ‚Â²ğœ™âˆ‚xâˆ‚z, âˆ‚Â²ğœ™âˆ‚yâˆ‚z, âˆ‚Â²ğœ™âˆ‚zÂ² = getâˆ‡Â²ğœ™(ap,xáµ¢,Î”x)
        for I in 1:n
            for J in 1:I
                ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]
                âˆ‚ğ— âˆ‚z[I,J] += âˆ‚ğœ™âˆ‚z*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J]

                âˆ‚Â²ğ— âˆ‚xÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J]

                âˆ‚Â²ğ— âˆ‚yÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J]

                âˆ‚Â²ğ— âˆ‚zÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚zÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚zÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚zÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚z*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚z*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚z[I]*âˆ‚ğ’‘âˆ‚z[J]

                âˆ‚Â²ğ— âˆ‚xâˆ‚y[I,J] += âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J]

                âˆ‚Â²ğ— âˆ‚xâˆ‚z[I,J] += âˆ‚Â²ğœ™âˆ‚xâˆ‚z*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚z[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚z[J] + âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚z*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J] + âˆ‚ğœ™âˆ‚z*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚z[J] + ğœ™*âˆ‚ğ’‘âˆ‚z[I]*âˆ‚ğ’‘âˆ‚x[J]

                âˆ‚Â²ğ— âˆ‚yâˆ‚z[I,J] += âˆ‚Â²ğœ™âˆ‚yâˆ‚z*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yâˆ‚z[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yâˆ‚z[J] + âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚z[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚z*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚z[J] + âˆ‚ğœ™âˆ‚z*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚z[J] + ğœ™*âˆ‚ğ’‘âˆ‚z[I]*âˆ‚ğ’‘âˆ‚y[J]
            end
        end
    end
    cholesky!(ğ— )
    U = inverse!(ğ— )
    Uáµ€âˆ‚ğ— âˆ‚xU = Uáµ€AU!(âˆ‚ğ— âˆ‚x,U)
    Uáµ€âˆ‚ğ— âˆ‚yU = Uáµ€AU!(âˆ‚ğ— âˆ‚y,U)
    Uáµ€âˆ‚ğ— âˆ‚zU = Uáµ€AU!(âˆ‚ğ— âˆ‚z,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xÂ²,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚yÂ²,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚zÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚zÂ²,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xâˆ‚y,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚zU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xâˆ‚z,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚yâˆ‚zU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚yâˆ‚z,U)
    for i in 1:n
        for j in 1:i
            for k in 1:n
                Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚zÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚zU[i,k]*Uáµ€âˆ‚ğ— âˆ‚zU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j] + Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚zU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚zU[k,j] + Uáµ€âˆ‚ğ— âˆ‚zU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚yâˆ‚zU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚zU[k,j] + Uáµ€âˆ‚ğ— âˆ‚zU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
            end
        end
    end

    âˆ‚Â²ğ— â»Â¹âˆ‚xÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚yÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚zÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚zÂ²U,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚z = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚zU,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚yâˆ‚z = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚yâˆ‚zU,U)
    âˆ‚ğ— â»Â¹âˆ‚x = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚xU,U)
    âˆ‚ğ— â»Â¹âˆ‚y = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚yU,U)
    âˆ‚ğ— â»Â¹âˆ‚z = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚zU,U)
    ğ— â»Â¹ = UUáµ€!(U)
    return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚yÂ², âˆ‚ğ— â»Â¹âˆ‚z, âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚z, âˆ‚Â²ğ— â»Â¹âˆ‚yâˆ‚z, âˆ‚Â²ğ— â»Â¹âˆ‚zÂ²
end

function calâˆ‡Â³ğ— !(ap::ReproducingKernel,x::Node)
    ğ“’ = ap.ğ“’
    ğ—  = getğ— (ap,:ğ— )
    âˆ‚ğ— âˆ‚x = getğ— (ap,:âˆ‚ğ— âˆ‚x)
    âˆ‚ğ— âˆ‚y = getğ— (ap,:âˆ‚ğ— âˆ‚y)
    âˆ‚Â²ğ— âˆ‚xÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xÂ²)
    âˆ‚Â²ğ— âˆ‚xâˆ‚y = getğ— (ap,:âˆ‚Â²ğ— âˆ‚xâˆ‚y)
    âˆ‚Â²ğ— âˆ‚yÂ² = getğ— (ap,:âˆ‚Â²ğ— âˆ‚yÂ²)
    âˆ‚Â³ğ— âˆ‚xÂ³ = getğ— (ap,:âˆ‚Â³ğ— âˆ‚xÂ³)
    âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚y = getğ— (ap,:âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚y)
    âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ² = getğ— (ap,:âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²)
    âˆ‚Â³ğ— âˆ‚yÂ³ = getğ— (ap,:âˆ‚Â³ğ— âˆ‚yÂ³)
    n = getğ‘›ğ’‘(ap)
    for xáµ¢ in ğ“’
        Î”x = x - xáµ¢
        ğ’‘, âˆ‚ğ’‘âˆ‚x, âˆ‚ğ’‘âˆ‚y, âˆ‚Â²ğ’‘âˆ‚xÂ², âˆ‚Â²ğ’‘âˆ‚xâˆ‚y, âˆ‚Â²ğ’‘âˆ‚yÂ², âˆ‚Â³ğ’‘âˆ‚xÂ³, âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ², âˆ‚Â³ğ’‘âˆ‚yÂ³ = getâˆ‡Â³ğ’‘(ap,Î”x)
        ğœ™, âˆ‚ğœ™âˆ‚x, âˆ‚ğœ™âˆ‚y, âˆ‚Â²ğœ™âˆ‚xÂ², âˆ‚Â²ğœ™âˆ‚xâˆ‚y, âˆ‚Â²ğœ™âˆ‚yÂ², âˆ‚Â³ğœ™âˆ‚xÂ³, âˆ‚Â³ğœ™âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğœ™âˆ‚xâˆ‚yÂ², âˆ‚Â³ğœ™âˆ‚yÂ³ = getâˆ‡Â³ğœ™(ap,xáµ¢,Î”x)
        for I in 1:n
            for J in I:n
                ğ— [I,J] += ğœ™*ğ’‘[I]*ğ’‘[J]
                âˆ‚ğ— âˆ‚x[I,J] += âˆ‚ğœ™âˆ‚x*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J]
                âˆ‚ğ— âˆ‚y[I,J] += âˆ‚ğœ™âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J]

                âˆ‚Â²ğ— âˆ‚xÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J]

                âˆ‚Â²ğ— âˆ‚xâˆ‚y[I,J] += âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J]

                âˆ‚Â²ğ— âˆ‚yÂ²[I,J] += âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J]

                âˆ‚Â³ğ— âˆ‚xÂ³[I,J] += âˆ‚Â³ğœ™âˆ‚xÂ³*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â³ğ’‘âˆ‚xÂ³[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â³ğ’‘âˆ‚xÂ³[J] + 3.0*âˆ‚Â²ğœ™âˆ‚xÂ²*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 3.0*âˆ‚ğœ™âˆ‚x*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + 3.0*âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 3.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 3.0*ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*âˆ‚ğ’‘âˆ‚x[J] + 3.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 6.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J]

                âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚y[I,J] += âˆ‚Â³ğœ™âˆ‚xÂ²âˆ‚y*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â³ğ’‘âˆ‚xÂ²âˆ‚y[J] + 2.0*âˆ‚Â²ğœ™âˆ‚xâˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + âˆ‚Â²ğœ™âˆ‚xÂ²*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚y*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*ğ’‘[J] + 2.0*âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + âˆ‚Â²ğœ™âˆ‚xÂ²*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚xÂ²[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚Â²ğ’‘âˆ‚xÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J]

                âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²[I,J] += âˆ‚Â³ğœ™âˆ‚xâˆ‚yÂ²*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â³ğ’‘âˆ‚xâˆ‚yÂ²[J] + 2.0*âˆ‚Â²ğœ™âˆ‚xâˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + âˆ‚Â²ğœ™âˆ‚yÂ²*âˆ‚ğ’‘âˆ‚x[I]*ğ’‘[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*ğ’‘[J] + âˆ‚ğœ™âˆ‚x*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + 2.0*âˆ‚Â²ğœ™âˆ‚xâˆ‚y*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + âˆ‚ğœ™âˆ‚x*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*ğœ™*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J] + ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*âˆ‚ğ’‘âˆ‚x[J] + 2.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚Â²ğ’‘âˆ‚xâˆ‚y[J] + ğœ™*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 2.0*âˆ‚ğœ™âˆ‚x*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚x[I]*âˆ‚ğ’‘âˆ‚y[J] + 2.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚x[J]

                âˆ‚Â³ğ— âˆ‚yÂ³[I,J] += âˆ‚Â³ğœ™âˆ‚yÂ³*ğ’‘[I]*ğ’‘[J] + ğœ™*âˆ‚Â³ğ’‘âˆ‚yÂ³[I]*ğ’‘[J] + ğœ™*ğ’‘[I]*âˆ‚Â³ğ’‘âˆ‚yÂ³[J] + 3.0*âˆ‚Â²ğœ™âˆ‚yÂ²*âˆ‚ğ’‘âˆ‚y[I]*ğ’‘[J] + 3.0*âˆ‚ğœ™âˆ‚y*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*ğ’‘[J] + 3.0*âˆ‚Â²ğœ™âˆ‚yÂ²*ğ’‘[I]*âˆ‚ğ’‘âˆ‚y[J] + 3.0*âˆ‚ğœ™âˆ‚y*ğ’‘[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 3.0*ğœ™*âˆ‚Â²ğ’‘âˆ‚yÂ²[I]*âˆ‚ğ’‘âˆ‚y[J] + 3.0*ğœ™*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚Â²ğ’‘âˆ‚yÂ²[J] + 6.0*âˆ‚ğœ™âˆ‚y*âˆ‚ğ’‘âˆ‚y[I]*âˆ‚ğ’‘âˆ‚y[J]
            end
        end
    end
    cholesky!(ğ— )
    U = inverse!(ğ— )
    Uáµ€âˆ‚ğ— âˆ‚xU = Uáµ€AU!(âˆ‚ğ— âˆ‚x,U)
    Uáµ€âˆ‚ğ— âˆ‚yU = Uáµ€AU!(âˆ‚ğ— âˆ‚y,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xÂ²,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚yÂ²,U)
    Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU = Uáµ€AU!(âˆ‚Â²ğ— âˆ‚xâˆ‚y,U)
    Uáµ€âˆ‚Â³ğ— âˆ‚xÂ³U = Uáµ€AU!(âˆ‚Â³ğ— âˆ‚xÂ³,U)
    Uáµ€âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚yU = Uáµ€AU!(âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚y,U)
    Uáµ€âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²U = Uáµ€AU!(âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²,U)
    Uáµ€âˆ‚Â³ğ— âˆ‚yÂ³U = Uáµ€AU!(âˆ‚Â³ğ— âˆ‚yÂ³,U)

    for i in 1:n
        for j in 1:i
            for k in 1:n
                Uáµ€âˆ‚Â³ğ— âˆ‚xÂ³U[i,j] -= 3*Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                Uáµ€âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚yU[i,j] -= 2*Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]+Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                Uáµ€âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]+Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                Uáµ€âˆ‚Â³ğ— âˆ‚yÂ³U[i,j] -= 3*Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
            end
        end
        for j in 1:i
            for k in 1:n
                Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j]
                Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[i,j] -= Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚ğ— âˆ‚yU[k,j] + Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚ğ— âˆ‚xU[k,j]
            end
        end
    end
    for i in 1:n
        for j in 1:i
            for k in 1:n
                Uáµ€âˆ‚Â³ğ— âˆ‚xÂ³U[i,j] -= 3*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[k,j]
                Uáµ€âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚yU[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[k,j]+Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U[k,j]
                Uáµ€âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²U[i,j] -= 2*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU[k,j]+Uáµ€âˆ‚ğ— âˆ‚xU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[k,j]
                Uáµ€âˆ‚Â³ğ— âˆ‚yÂ³U[i,j] -= 3*Uáµ€âˆ‚ğ— âˆ‚yU[i,k]*Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U[k,j]
            end
        end
    end

    âˆ‚Â³ğ— â»Â¹âˆ‚xÂ³ = - UAUáµ€!(Uáµ€âˆ‚Â³ğ— âˆ‚xÂ³U,U)
    âˆ‚Â³ğ— â»Â¹âˆ‚xÂ²âˆ‚y = - UAUáµ€!(Uáµ€âˆ‚Â³ğ— âˆ‚xÂ²âˆ‚yU,U)
    âˆ‚Â³ğ— â»Â¹âˆ‚xâˆ‚yÂ² = - UAUáµ€!(Uáµ€âˆ‚Â³ğ— âˆ‚xâˆ‚yÂ²U,U)
    âˆ‚Â³ğ— â»Â¹âˆ‚yÂ³ = - UAUáµ€!(Uáµ€âˆ‚Â³ğ— âˆ‚yÂ³U,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚xÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xÂ²U,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚yÂ² = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚yÂ²U,U)
    âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y = - UAUáµ€!(Uáµ€âˆ‚Â²ğ— âˆ‚xâˆ‚yU,U)
    âˆ‚ğ— â»Â¹âˆ‚x = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚xU,U)
    âˆ‚ğ— â»Â¹âˆ‚y = - UAUáµ€!(Uáµ€âˆ‚ğ— âˆ‚yU,U)
    ğ— â»Â¹ = UUáµ€!(U)

    return ğ— â»Â¹, âˆ‚ğ— â»Â¹âˆ‚x, âˆ‚ğ— â»Â¹âˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚xÂ², âˆ‚Â²ğ— â»Â¹âˆ‚xâˆ‚y, âˆ‚Â²ğ— â»Â¹âˆ‚yÂ², âˆ‚Â³ğ— â»Â¹âˆ‚xÂ³, âˆ‚Â³ğ— â»Â¹âˆ‚xÂ²âˆ‚y, âˆ‚Â³ğ— â»Â¹âˆ‚xâˆ‚yÂ², âˆ‚Â³ğ— â»Â¹âˆ‚yÂ³
end

function calğ—š!(ap::ReproducingKernel{ğ‘,ğ‘ ,ğœ™,:Poi1}) where {ğ‘,ğ‘ ,ğœ™}
    ğ“’ = ap.ğ“’
    ğ“– = ap.ğ“–
    ğ—š = getğ—š(ap,:âˆ‡Ìƒ)
    x = ğ“’[1]
    n = getğ‘›ğ’‘â‚(ap)
    for Î¾ in ğ“–
        Î”x = x - Î¾
        ğ’’ = getğ’‘â‚(ap,Î¾)
        w = getğœ™(ap,x,Î”x)
        for I in 1:n
            for J in 1:I
                ğ—š[I,J] += w*ğ’’[I]*ğ’’[J]
            end
        end
    end
    cholesky!(ğ—š)
    inverse!(ğ—š)
    UUáµ€!(ğ—š)
    return ğ—š
end

function calğ—š!(ap::ReproducingKernel{:Linear1D,ğ‘ ,ğœ™,:Seg2}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡Ìƒ)
    ğ¿ = ap.ğ“–[1].ğ¿
    ğ—šâ»Â¹[1] =  1.0/ğ¿
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{:Quadratic1D,ğ‘ ,ğœ™,:Seg2}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡Ìƒ)
    ğ¿ = ap.ğ“–[1].ğ¿
    ğ—šâ»Â¹[1] =  4.0/ğ¿
    ğ—šâ»Â¹[2] = -6.0/ğ¿
    ğ—šâ»Â¹[3] = 12.0/ğ¿
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{:Cubic1D,ğ‘ ,ğœ™,:Seg2}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡Ìƒ)
    ğ¿ = ap.ğ“–[1].ğ¿
    ğ—šâ»Â¹[1] =    9.0/ğ¿
    ğ—šâ»Â¹[2] =  -36.0/ğ¿
    ğ—šâ»Â¹[3] =  192.0/ğ¿
    ğ—šâ»Â¹[4] =   30.0/ğ¿
    ğ—šâ»Â¹[5] = -180.0/ğ¿
    ğ—šâ»Â¹[6] =  180.0/ğ¿
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{:Linear2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡Ìƒ)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] = 1.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{:Quadratic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡Ìƒ)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   9.0/ğ´
    ğ—šâ»Â¹[2] = -12.0/ğ´
    ğ—šâ»Â¹[3] =  24.0/ğ´
    ğ—šâ»Â¹[4] = -12.0/ğ´
    ğ—šâ»Â¹[5] =  12.0/ğ´
    ğ—šâ»Â¹[6] =  24.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—š!(ap::ReproducingKernel{:Cubic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡Ìƒ)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   36.0/ğ´
    ğ—šâ»Â¹[2] = -120.0/ğ´
    ğ—šâ»Â¹[3] =  600.0/ğ´
    ğ—šâ»Â¹[4] = -120.0/ğ´
    ğ—šâ»Â¹[5] =  300.0/ğ´
    ğ—šâ»Â¹[6] =  600.0/ğ´
    ğ—šâ»Â¹[7] =   90.0/ğ´
    ğ—šâ»Â¹[8] = -540.0/ğ´
    ğ—šâ»Â¹[9] = -180.0/ğ´
    ğ—šâ»Â¹[10] =  540.0/ğ´
    ğ—šâ»Â¹[11] =  180.0/ğ´
    ğ—šâ»Â¹[12] = -720.0/ğ´
    ğ—šâ»Â¹[13] = -720.0/ğ´
    ğ—šâ»Â¹[14] =  540.0/ğ´
    ğ—šâ»Â¹[15] = 1440.0/ğ´
    ğ—šâ»Â¹[16] =   90.0/ğ´
    ğ—šâ»Â¹[17] = -180.0/ğ´
    ğ—šâ»Â¹[18] = -540.0/ğ´
    ğ—šâ»Â¹[19] =   90.0/ğ´
    ğ—šâ»Â¹[20] =  540.0/ğ´
    ğ—šâ»Â¹[21] =  540.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—šâ‚‚!(ap::ReproducingKernel{:Quadratic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] = 1.0/ğ´
    return ğ—šâ»Â¹
end

function calğ—šâ‚‚!(ap::ReproducingKernel{:Cubic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   9.0/ğ´
    ğ—šâ»Â¹[2] = -12.0/ğ´
    ğ—šâ»Â¹[3] =  24.0/ğ´
    ğ—šâ»Â¹[4] = -12.0/ğ´
    ğ—šâ»Â¹[5] =  12.0/ğ´
    ğ—šâ»Â¹[6] =  24.0/ğ´
    return ğ—šâ»Â¹
end

function calâˆ‡ğ—šâ‚‚!(ap::ReproducingKernel{:Cubic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ—šâ»Â¹âˆ‚Î¾ = getğ—š(ap,:âˆ‚âˆ‡ÌƒÂ²âˆ‚Î¾)
    ğ—šâ»Â¹âˆ‚Î· = getğ—š(ap,:âˆ‚âˆ‡ÌƒÂ²âˆ‚Î·)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   9.0/ğ´
    ğ—šâ»Â¹[2] = -12.0/ğ´
    ğ—šâ»Â¹[3] =  24.0/ğ´
    ğ—šâ»Â¹[4] = -12.0/ğ´
    ğ—šâ»Â¹[5] =  12.0/ğ´
    ğ—šâ»Â¹[6] =  24.0/ğ´

    ğ—šâ»Â¹âˆ‚Î¾[1] =   9.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[2] = -12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[3] =  24.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[4] = -12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[5] =  12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[6] =  24.0/ğ´

    ğ—šâ»Â¹âˆ‚Î·[1] =   9.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[2] = -12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[3] =  24.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[4] = -12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[5] =  12.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[6] =  24.0/ğ´

    return ğ—šâ»Â¹,ğ—šâ»Â¹âˆ‚Î¾,ğ—šâ»Â¹âˆ‚Î·
end

function calğ—šâ‚‚!(ap::ReproducingKernel{:Quartic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   36.0/ğ´
    ğ—šâ»Â¹[2] = -120.0/ğ´
    ğ—šâ»Â¹[3] =  600.0/ğ´
    ğ—šâ»Â¹[4] = -120.0/ğ´
    ğ—šâ»Â¹[5] =  300.0/ğ´
    ğ—šâ»Â¹[6] =  600.0/ğ´
    ğ—šâ»Â¹[7] =   90.0/ğ´
    ğ—šâ»Â¹[8] = -540.0/ğ´
    ğ—šâ»Â¹[9] = -180.0/ğ´
    ğ—šâ»Â¹[10] =  540.0/ğ´
    ğ—šâ»Â¹[11] =  180.0/ğ´
    ğ—šâ»Â¹[12] = -720.0/ğ´
    ğ—šâ»Â¹[13] = -720.0/ğ´
    ğ—šâ»Â¹[14] =  540.0/ğ´
    ğ—šâ»Â¹[15] = 1440.0/ğ´
    ğ—šâ»Â¹[16] =   90.0/ğ´
    ğ—šâ»Â¹[17] = -180.0/ğ´
    ğ—šâ»Â¹[18] = -540.0/ğ´
    ğ—šâ»Â¹[19] =   90.0/ğ´
    ğ—šâ»Â¹[20] =  540.0/ğ´
    ğ—šâ»Â¹[21] =  540.0/ğ´
    return ğ—šâ»Â¹
end

function calâˆ‡ğ—šâ‚‚!(ap::ReproducingKernel{:Quartic2D,ğ‘ ,ğœ™,:Tri3}) where {ğ‘ ,ğœ™}
    ğ—šâ»Â¹ = getğ—š(ap,:âˆ‡ÌƒÂ²)
    ğ—šâ»Â¹âˆ‚Î¾ = getğ—š(ap,:âˆ‚âˆ‡ÌƒÂ²âˆ‚Î¾)
    ğ—šâ»Â¹âˆ‚Î· = getğ—š(ap,:âˆ‚âˆ‡ÌƒÂ²âˆ‚Î·)
    ğ´ = ap.ğ“–[1].ğ´
    ğ—šâ»Â¹[1] =   36.0/ğ´
    ğ—šâ»Â¹[2] = -120.0/ğ´
    ğ—šâ»Â¹[3] =  600.0/ğ´
    ğ—šâ»Â¹[4] = -120.0/ğ´
    ğ—šâ»Â¹[5] =  300.0/ğ´
    ğ—šâ»Â¹[6] =  600.0/ğ´
    ğ—šâ»Â¹[7] =   90.0/ğ´
    ğ—šâ»Â¹[8] = -540.0/ğ´
    ğ—šâ»Â¹[9] = -180.0/ğ´
    ğ—šâ»Â¹[10] =  540.0/ğ´
    ğ—šâ»Â¹[11] =  180.0/ğ´
    ğ—šâ»Â¹[12] = -720.0/ğ´
    ğ—šâ»Â¹[13] = -720.0/ğ´
    ğ—šâ»Â¹[14] =  540.0/ğ´
    ğ—šâ»Â¹[15] = 1440.0/ğ´
    ğ—šâ»Â¹[16] =   90.0/ğ´
    ğ—šâ»Â¹[17] = -180.0/ğ´
    ğ—šâ»Â¹[18] = -540.0/ğ´
    ğ—šâ»Â¹[19] =   90.0/ğ´
    ğ—šâ»Â¹[20] =  540.0/ğ´
    ğ—šâ»Â¹[21] =  540.0/ğ´

    ğ—šâ»Â¹âˆ‚Î¾[1] =   36.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[2] = -120.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[3] =  600.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[4] = -120.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[5] =  300.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[6] =  600.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[7] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[8] = -540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[9] = -180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[10] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[11] =  180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[12] = -720.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[13] = -720.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[14] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[15] = 1440.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[16] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[17] = -180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[18] = -540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[19] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[20] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î¾[21] =  540.0/ğ´

    ğ—šâ»Â¹âˆ‚Î·[1] =   36.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[2] = -120.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[3] =  600.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[4] = -120.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[5] =  300.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[6] =  600.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[7] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[8] = -540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[9] = -180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[10] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[11] =  180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[12] = -720.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[13] = -720.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[14] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[15] = 1440.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[16] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[17] = -180.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[18] = -540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[19] =   90.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[20] =  540.0/ğ´
    ğ—šâ»Â¹âˆ‚Î·[21] =  540.0/ğ´

    return ğ—šâ»Â¹,ğ—šâ»Â¹âˆ‚Î¾,ğ—šâ»Â¹âˆ‚Î·
end